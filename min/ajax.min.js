(function(){var e,t,r,a;a=function(e,a){var n,o,d,p,h,l,i,c,s,u,m,g,f,b,y,v,w,T,k,O,H,S,C,j,x,N,D,P,A,E,G,B;if($("#leadsTable").empty(),$("#ordersTable").empty(),$("#combinedTable").empty(),$("#barGraphError").empty(),$("#chart").empty(),a=JSON.parse(a),e=JSON.parse(e),i=t(a,e),0===a.length&&0===e.length&&0===i.length?($("#barGraphError").empty(),$("#barGraphError").append("Error loading bar graph data")):r(a,e,i),a.length>0){for(u="<tr>",g=Object.keys(a[0]),b=0,T=g.length;T>b;b++)m=g[b],u+="<th>"+m+"</th>";for(u+="</tr>",$("#ordersTable").append(u),y=0,k=a.length;k>y;y++){for(s=a[y],f="<tr>",v=0,O=g.length;O>v;v++)c=g[v],f+="<td>"+s[c]+"</td>";f+="</tr>",$("#ordersTable").append(f)}}else $("#ordersTable").append("<tr><th>No Orders for selected time span</th></tr>");if(e.length>0){for(d="<tr>",h=Object.keys(e[0]),w=0,H=h.length;H>w;w++)p=h[w],d+="<th>"+p+"</th>";for(d+="</tr>",$("#leadsTable").append(d),D=0,S=e.length;S>D;D++){for(o=e[D],l="<tr>",P=0,C=h.length;C>P;P++)n=h[P],l+="<td>"+o[n]+"</td>";l+="</tr>",$("#leadsTable").append(l)}}else $("#leadsTable").append("<tr><th>No leads for selected time span</th></tr>");if(i.length>0){for(d="<tr>",h=Object.keys(e[0]),A=0,j=h.length;j>A;A++)p=h[A],d+="<th>"+p+"</th>";for(d+="</tr>",$("#combinedTable").append(d),B=[],E=0,x=e.length;x>E;E++){for(o=e[E],l="<tr>",G=0,N=h.length;N>G;G++)n=h[G],l+="<td>"+o[n]+"</td>";l+="</tr>",B.push($("#combinedTable").append(l))}return B}return $("#combinedTable").append("<tr><th>No matches between leads and orders for this time frame</th></tr>")},r=function(e,t,r){var a,n,o,d;return n={labels:["Order Count","Lead Count","Match count"],datasets:[{label:"Order Count",fillColor:"rgba(90, 133, 247, 0.7)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:[e.length,t.length,r.length]}]},$("#chart").append("<canvas id='myChart' width='800' height='500'></canvas>"),a=$("#myChart").get(0).getContext("2d"),d={scaleBeginAtZero:!0,scaleShowGridLines:!0},o=new Chart(a).Bar(n,d)},e=function(e){var t,r;return t="",r="",$.ajax("/getLeadsAjax.php",{type:"POST",data:{timeSpan:e},error:function(e,t){return console.log(t)},success:function(n){return t=n,$.ajax("/getOrdersAjax.php",{type:"POST",data:{timeSpan:e},error:function(e,t){return console.log(t)},success:function(e){return r=e,a(t,r)}})}})},t=function(e,t){var r,a,n,o,d,p,h,l;for(o=[],l=[],p=0,h=t.length;h>p;p++)r=t[p],l.push(function(){var p,h,l;for(l=[],p=0,h=e.length;h>p;p++)d=e[p],r.phone===d.homePhone||r.phone===d.cellPhone||r.phone===d.homePhone?(n=r,l.push(function(){var e,d,p;for(p=[],e=0,d=t.length;d>e;e++)a=t[e],a.dateCreated!==n.dateCreated?p.push(o.push(r)):p.push(void 0);return p}())):l.push(void 0);return l}());return l},$("document").ready(function(){return $("#btn-day").click(function(){return $("#timeHead").empty(),$("#timeHead").append("Data covering past day"),e("day")}),$("#btn-month").click(function(){return $("#timeHead").empty(),$("#timeHead").append("Data covering past month"),e("month")}),$("#btn-week").click(function(){return $("#timeHead").empty(),$("#timeHead").append("Data covering past week"),e("week")}),$("#btn-6month").click(function(){return $("#timeHead").empty(),$("#timeHead").append("Data covering past 6 months"),e("halfyear")}),$("#btn-year").click(function(){return $("#timeHead").empty(),$("#timeHead").append("Data covering past year"),e("year")}),$("#logonButton").click(function(){var e,t;return t=$("#userName").val(),e=$("#password").val(),$.ajax("/logonAjax.php",{type:"POST",data:{userName:t,password:e},error:function(e,t){return console.log(t)},success:function(e){var t;return t=JSON.parse(e),"Success"===t.Status?window.location.href="/":void 0}})}),console.log(window.location),"/index.php"===window.location.pathname||"/"===window.location.pathname?($("#timeHead").empty(),$("#timeHead").append("Data covering past month"),e("month")):void 0})}).call(this);